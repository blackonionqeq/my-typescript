# 至最新版本为止的总结

## 21-11-12
极简版成形。
只包含识别函数声明和函数调用的功能，不过麻雀虽小五脏俱全，跟大而全的编译器一样，整体可分为几个部分：词法分析器、语法分析器、语义分析器和执行器。

词法分析器是把代码（字符流）加工为一个有意义的最小单位（token）的流，以便后面以最小单位为单位对代码进行处理。实现的要点，是要十分小心什么时候peek，什么时候next（区别是是否消化掉当前字符）。有个优化的手段，是预读后缩小可能字符结果的集合来减少回溯。

语法分析器把token流加工为一棵树，以便后面对树进行遍历以实现执行的效果。实现的要点，和词法分析一样小心什么时候peek什么时候next（不一样的是词法分析吐掉的是token而非字符），可以注释每个分析函数的EBNF或正则匹配来理清逻辑。有个优化的手段，是预读后缩小可能token结果的集合来减少回溯。

语义分析器是对树进行加工，以省去运行时需要进行的一些操作，例如找到函数调用对应的函数等。实现需要遍历树的方法，并在合适的时机进行需要的转化或求值。

执行器遍历语法树，执行相应逻辑。和语义分析类似，遍历树时在合适的时机进行合适的求值等操作。
